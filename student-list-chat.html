<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>M.M Public School Mundeshwari â€“ Student Chat List</title>
<meta name="description"
content="M.M Public School Mundeshwari Official Website. Online Admission, Notes, Test Series, Demo Class, Student Portal and School Updates.">

<meta name="keywords"
content="MM Public School Mundeshwari, school website, online admission, student portal, demo class, notes download, Bihar school">

<meta name="author" content="M.M Public School Mundeshwari">

<meta name="robots" content="index, follow">

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Google Search Verification (à¤¬à¤¾à¤¦ à¤®à¥‡à¤‚ code à¤®à¤¿à¤²à¥‡à¤—à¤¾ à¤¤à¥‹ à¤¯à¤¹à¤¾à¤ à¤¡à¤¾à¤²à¤¨à¤¾) -->
<meta name="google-site-verification" content="PASTE_YOUR_CODE_HERE">

<link rel="stylesheet"
href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>

body{
margin:0;
font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;
background:#edf3ff;
}

/* ===== HEADER ===== */
.header{
background:linear-gradient(135deg,#0b3d91,#2563eb);
color:#fff;
padding:16px;
font-weight:900;
font-size:17px;
text-align:center;
box-shadow:0 10px 24px rgba(0,0,0,.18);
}

/* ===== CATEGORY BAR ===== */
.category{
display:flex;
gap:10px;
padding:12px;
}

.cat-btn{
flex:1;
padding:12px;
border:none;
border-radius:12px;
font-weight:900;
background:#fff;
color:#0b3d91;
box-shadow:0 6px 14px rgba(0,0,0,.12);
}

.cat-btn.active{
background:#0b3d91;
color:#fff;
}

/* ===== LIST ===== */
#list{
padding:14px;
}

/* ===== CARD ===== */
.card{
background:#fff;
border-radius:18px;
padding:14px;
margin-bottom:12px;
box-shadow:0 10px 22px rgba(0,0,0,.12);
display:flex;
align-items:center;
gap:14px;
border-left:5px solid #2563eb;
cursor:pointer;
transition:.35s;
animation:fadeUp .35s ease;
}

.card.pinned{
border-left:5px solid #ff9800;
background:linear-gradient(135deg,#fff8e1,#ffffff);
transform:scale(1.02);
}

.avatar{
width:52px;
height:52px;
border-radius:50%;
display:flex;
align-items:center;
justify-content:center;
font-size:26px;
background:#e6ecff;
}

.info{flex:1;}

.name{
font-size:16px;
font-weight:900;
color:#0b3d91;
}

.sid{
margin-top:4px;
font-size:13px;
font-weight:800;
color:#444;
}

/* FAST LOADING */
.loading{
background:#fff;
padding:24px;
border-radius:18px;
box-shadow:0 8px 18px rgba(0,0,0,.12);
text-align:center;
font-weight:900;
color:#0b3d91;
}

.progress{
width:100%;
height:6px;
margin-top:12px;
background:#dde5ff;
border-radius:50px;
overflow:hidden;
}

.progress span{
display:block;
height:100%;
width:35%;
background:linear-gradient(90deg,#0b3d91,#2563eb);
animation:slideFast .7s linear infinite;
}

@keyframes slideFast{
0%{transform:translateX(-120%)}
100%{transform:translateX(260%)}
}

.empty{
text-align:center;
padding:50px 20px;
font-size:17px;
font-weight:900;
color:#0b3d91;
}

@keyframes fadeUp{
from{opacity:0;transform:translateY(20px)}
to{opacity:1;transform:translateY(0)}
}

</style>
</head>

<body>

<div class="header">
Student List Chat
</div>

<!-- CATEGORY BUTTON -->
<div class="category">
<button id="allBtn" class="cat-btn active">Student List</button>
<button id="favBtn" class="cat-btn">Favourite Student List</button>
</div>

<div id="list">
<div class="loading">
Fetching Students...
<div class="progress"><span></span></div>
</div>
</div>

<script type="module">

import { initializeApp } from
"https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";

import { getDatabase, ref, onValue, set, remove }
from "https://www.gstatic.com/firebasejs/12.6.0/firebase-database.js";

const firebaseConfig={
apiKey:"AIzaSyAHAQjn4sTuR9FiGF3ljRrFEMZQjsx-SHg",
authDomain:"apni-duniya-b53d7.firebaseapp.com",
databaseURL:"https://apni-duniya-b53d7-default-rtdb.firebaseio.com",
projectId:"apni-duniya-b53d7"
};

const app=initializeApp(firebaseConfig);
const db=getDatabase(app);

const list=document.getElementById("list");
const allBtn=document.getElementById("allBtn");
const favBtn=document.getElementById("favBtn");

let mode="all";
let studentsData={};
let favData={};

/* ===== LOAD FAVOURITES REALTIME ===== */
onValue(ref(db,"favouriteStudents"),snap=>{
favData=snap.val()||{};
render();
});

/* ===== LOAD STUDENTS ===== */
onValue(ref(db,"students"),snap=>{

studentsData={};
snap.forEach(c=>{
studentsData[c.key]=c.val();
});

render();

});

/* ===== RENDER FUNCTION ===== */
function render(){

list.innerHTML="";

let keys=Object.keys(studentsData);

/* FILTER MODE */
if(mode==="fav"){
keys=keys.filter(k=>favData[k]);
}

/* SORT favourite top */
keys.sort((a,b)=>{
if(favData[a] && !favData[b]) return -1;
if(!favData[a] && favData[b]) return 1;
return 0;
});

if(keys.length===0){
list.innerHTML="<div class='empty'>No student available</div>";
return;
}

keys.forEach(id=>{

const d=studentsData[id];
const avatar=d.avatar || "ðŸ‘¦";

const card=document.createElement("div");
card.className="card";

if(favData[id]) card.classList.add("pinned");

/* TAP SYSTEM */
let tapTimer=null;
let lastTap=0;

card.addEventListener("click",()=>{

const now=Date.now();

/* DOUBLE TAP â†’ TOGGLE FAV */
if(now-lastTap<300){

clearTimeout(tapTimer);

if(favData[id]){
remove(ref(db,"favouriteStudents/"+id));
}else{
set(ref(db,"favouriteStudents/"+id),true);
}

lastTap=0;
return;
}

/* SINGLE TAP â†’ CHAT */
tapTimer=setTimeout(()=>{
window.location.href=
"chat.html?uid="+id+
"&name="+encodeURIComponent(d.name||"Student");
},250);

lastTap=now;

});

card.innerHTML=`
<div class="avatar">${avatar}</div>
<div class="info">
<div class="name">${d.name||"Student"}</div>
<div class="sid">School ID : ${id}</div>
</div>
`;

list.appendChild(card);

});

}

/* CATEGORY SWITCH */
allBtn.onclick=()=>{
mode="all";
allBtn.classList.add("active");
favBtn.classList.remove("active");
render();
};

favBtn.onclick=()=>{
mode="fav";
favBtn.classList.add("active");
allBtn.classList.remove("active");
render();
};

</script>
</body>
</html>