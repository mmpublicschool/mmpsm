<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>M.M Public School Mundeshwari â€“ Student Signup</title>
<meta name="description"
content="M.M Public School Mundeshwari Official Website. Online Admission, Notes, Test Series, Demo Class, Student Portal and School Updates.">

<meta name="keywords"
content="MM Public School Mundeshwari, school website, online admission, student portal, demo class, notes download, Bihar school">

<meta name="author" content="M.M Public School Mundeshwari">

<meta name="robots" content="index, follow">

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Google Search Verification (à¤¬à¤¾à¤¦ à¤®à¥‡à¤‚ code à¤®à¤¿à¤²à¥‡à¤—à¤¾ à¤¤à¥‹ à¤¯à¤¹à¤¾à¤ à¤¡à¤¾à¤²à¤¨à¤¾) -->
<meta name="google-site-verification" content="PASTE_YOUR_CODE_HERE">

<style>
body{
margin:0;
font-family:Arial;
background:#f4f6fb;
}

/* HEADER */
.header{
background:#0b3d91;
color:#fff;
padding:16px;
text-align:center;
font-weight:900;
font-size:18px;
}

/* CARD */
.card{
background:#fff;
margin:14px;
padding:18px;
border-radius:20px;
box-shadow:0 12px 28px rgba(0,0,0,.08);
}

.note{
background:#eef3ff;
padding:12px;
border-radius:12px;
font-size:12px;
margin-bottom:12px;
color:#0b3d91;
font-weight:700;
}

label{
font-size:13px;
font-weight:800;
color:#0b3d91;
}

input,select{
width:100%;
box-sizing:border-box;
padding:13px;
margin-bottom:12px;
border-radius:14px;
border:1px solid #e3e6ee;
background:#f9faff;
font-size:14px;
outline:none;
}

input:focus,select:focus{
border-color:#2563eb;
background:#fff;
}

.ok-btn{
width:100%;
padding:15px;
border:none;
border-radius:16px;
background:linear-gradient(45deg,#0b3d91,#2563eb);
color:#fff;
font-weight:900;
font-size:15px;
}

.profile-preview{
width:100px;
height:100px;
border-radius:50%;
background:#eef1f8;
margin:auto;
display:flex;
align-items:center;
justify-content:center;
font-size:48px;
margin-bottom:12px;
}

/* POPUP */
.popup{
position:fixed;
inset:0;
background:#0007;
display:none;
align-items:center;
justify-content:center;
z-index:9999;
}

.popup-card{
background:#fff;
padding:26px;
border-radius:22px;
width:85%;
max-width:330px;
text-align:center;
box-shadow:0 20px 40px rgba(0,0,0,.2);
}

.popup-title{
font-weight:900;
font-size:18px;
color:#0b3d91;
margin-bottom:6px;
}

.popup-id{
font-size:20px;
font-weight:900;
color:#2563eb;
margin-top:8px;
}

/* LOADING */
.loading{
position:fixed;
inset:0;
background:#0008;
color:#fff;
font-size:26px;
font-weight:900;
display:none;
align-items:center;
justify-content:center;
z-index:9998;
}
</style>
</head>

<body>

<header class="header">M. M PUBLIC SCHOOL SIGNUP</header>

<!-- STEP 1 -->
<div id="step1" class="card">
<div class="note">Enter details exactly as Aadhaar Card.</div>

<input id="nameInput" placeholder="Name">

<label>DOB</label>
<input id="dobInput" type="date">

<input id="aadhaarInput" placeholder="Aadhaar Number (12 digit)">
<input id="mobileInput" placeholder="Mobile Number (10 digit)">
<input id="fatherInput" placeholder="Father Name">
<input id="motherInput" placeholder="Mother Name">

<button id="next1Btn" class="ok-btn">Next</button>
</div>

<!-- STEP 2 -->
<div id="step2" class="card" style="display:none;">
<input id="mobile2Input" placeholder="Mobile Number">
<input id="emailInput" placeholder="Email (@gmail.com)">
<button id="next2Btn" class="ok-btn">Next</button>
</div>

<!-- STEP 3 -->
<div id="step3" class="card" style="display:none;">
<div class="profile-preview" id="preview">ðŸ‘¦</div>

<select id="genderSelect">
<option value="">Select Gender</option>
<option value="male">Male</option>
<option value="female">Female</option>
</select>

<input id="usernameInput" placeholder="Username">
<input id="passwordInput" type="password" placeholder="Password">

<button id="createBtn" class="ok-btn">Create Account</button>
</div>

<!-- POPUP -->
<div id="popup" class="popup">
<div class="popup-card">
<div id="popupTitle" class="popup-title"></div>
<div id="popupMsg"></div>
<div id="popupId" class="popup-id"></div>
</div>
</div>

<div id="loading" class="loading">Processing...</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
import { getDatabase, ref, get, set }
from "https://www.gstatic.com/firebasejs/12.6.0/firebase-database.js";

const firebaseConfig={
apiKey:"AIzaSyAHAQjn4sTuR9FiGF3ljRrFEMZQjsx-SHg",
authDomain:"apni-duniya-b53d7.firebaseapp.com",
databaseURL:"https://apni-duniya-b53d7-default-rtdb.firebaseio.com",
projectId:"apni-duniya-b53d7"
};

const app=initializeApp(firebaseConfig);
const db=getDatabase(app);

/* UI */
const popup=document.getElementById("popup");
const popupTitle=document.getElementById("popupTitle");
const popupMsg=document.getElementById("popupMsg");
const popupId=document.getElementById("popupId");
const loading=document.getElementById("loading");

function showPopup(t,m="",id=""){
popupTitle.innerText=t;
popupMsg.innerText=m;
popupId.innerText=id;
popup.style.display="flex";
setTimeout(()=>popup.style.display="none",2800);
}

/* INPUT CONTROL */
aadhaarInput.oninput=()=>aadhaarInput.value=aadhaarInput.value.replace(/\D/g,"").slice(0,12);
mobileInput.oninput=()=>mobileInput.value=mobileInput.value.replace(/\D/g,"").slice(0,10);
mobile2Input.oninput=()=>mobile2Input.value=mobile2Input.value.replace(/\D/g,"").slice(0,10);
genderSelect.onchange=()=>preview.innerText=genderSelect.value==="female"?"ðŸ‘§":"ðŸ‘¦";

/* STEP1 VALIDATION */
next1Btn.onclick=()=>{

let errors=[];

if(!nameInput.value) errors.push("Enter Name");
if(!dobInput.value) errors.push("Select DOB");
if(aadhaarInput.value.length!==12) errors.push("Aadhaar must be 12 digit");
if(mobileInput.value.length!==10) errors.push("Mobile must be 10 digit");
if(!fatherInput.value) errors.push("Enter Father Name");
if(!motherInput.value) errors.push("Enter Mother Name");

if(errors.length){
showPopup("Incomplete Form",errors.join("\n"));
return;
}

step1.style.display="none";
step2.style.display="block";
};

/* STEP2 VALIDATION */
next2Btn.onclick=()=>{

let errors=[];

if(mobile2Input.value.length!==10) errors.push("Enter valid Mobile");
if(!emailInput.value.endsWith("@gmail.com")) errors.push("Use Gmail only");

if(errors.length){
showPopup("Invalid Details",errors.join("\n"));
return;
}

step2.style.display="none";
step3.style.display="block";
};

/* REUSABLE SCHOOL ID */
async function generateSchoolId(){
const year=new Date().getFullYear();
const snap=await get(ref(db,"students"));
let used=[];
if(snap.exists()){
snap.forEach(s=>used.push(parseInt(s.key.split("-")[2])));
}
let n=1;
while(used.includes(n)){n++;}
return `MMPSM-${year}-${n.toString().padStart(2,"0")}`;
}

/* CREATE ACCOUNT */
createBtn.onclick=async()=>{

if(!usernameInput.value||!passwordInput.value||!genderSelect.value){
showPopup("Profile Incomplete","Fill Username, Password & Gender");
return;
}

loading.style.display="flex";

const schoolId=await generateSchoolId();

await set(ref(db,"students/"+schoolId),{
name:nameInput.value,
dob:dobInput.value,
aadhaar:aadhaarInput.value,
mobile:mobileInput.value,
email:emailInput.value,
username:usernameInput.value,
password:passwordInput.value,
gender:genderSelect.value
});

await set(ref(db,"session/currentUser"),schoolId);

loading.style.display="none";

showPopup(
"Signup Successful",
"M.M Public School\nStudent Account Created",
schoolId
);

setTimeout(()=>{
window.location.href="profile.html";
},3000);

};

</script>
</body>
</html>