<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <title>M.M Public School | Online Admission 2026-27</title>
    
    <!-- Font Awesome 6.5.2 (Official CDN) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #0a2a66;
            --primary-dark: #1e4b8f;
            --accent: #ff9800;
            --success: #10b981;
            --danger: #dc2626;
            --warning: #f59e0b;
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-300: #d1d5db;
            --gray-400: #9ca3af;
            --gray-500: #6b7280;
            --gray-600: #4b5563;
            --gray-700: #374151;
            --gray-800: #1f2937;
        }

        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, #f0f4fa 0%, #e6ecff 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 12px;
        }

        .container {
            max-width: 650px;
            width: 100%;
            margin: 0 auto;
        }

        /* ===== HEADER ===== */
        .header {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 24px 20px;
            border-radius: 32px 32px 0 0;
            text-align: center;
            box-shadow: 0 10px 25px rgba(10,42,102,0.2);
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -20%;
            width: 200px;
            height: 200px;
            background: rgba(255,255,255,0.05);
            border-radius: 50%;
        }

        .header h1 {
            font-size: 24px;
            font-weight: 800;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }

        .header h1 i {
            color: #ffd700;
            font-size: 28px;
        }

        .header p {
            font-size: 14px;
            opacity: 0.9;
        }

        /* ===== FORM BOX ===== */
        .form-box {
            background: white;
            border-radius: 0 0 32px 32px;
            padding: 28px 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }

        /* ===== PROGRESS STEPS ===== */
        .progress-steps {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            position: relative;
            padding: 0 5px;
        }

        .progress-steps::before {
            content: '';
            position: absolute;
            top: 15px;
            left: 0;
            width: 100%;
            height: 2px;
            background: var(--gray-200);
            z-index: 1;
        }

        .step {
            position: relative;
            z-index: 2;
            display: flex;
            flex-direction: column;
            align-items: center;
            background: white;
            padding: 0 5px;
        }

        .step-circle {
            width: 34px;
            height: 34px;
            border-radius: 50%;
            background: var(--gray-200);
            color: var(--gray-600);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 15px;
            margin-bottom: 6px;
            transition: all 0.3s;
            border: 2px solid transparent;
        }

        .step.active .step-circle {
            background: var(--primary);
            color: white;
            box-shadow: 0 0 0 4px rgba(10,42,102,0.1);
            transform: scale(1.1);
        }

        .step.completed .step-circle {
            background: var(--success);
            color: white;
        }

        .step-label {
            font-size: 10px;
            font-weight: 600;
            color: var(--gray-500);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .step.active .step-label {
            color: var(--primary);
            font-weight: 700;
        }

        /* ===== FORM STEPS ===== */
        .form-step {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .form-step.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* ===== SECTION TITLE ===== */
        .section-title {
            font-size: 18px;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            padding-bottom: 12px;
            border-bottom: 2px solid #e6ecff;
        }

        .section-title i {
            color: var(--accent);
            font-size: 20px;
        }

        /* ===== FORM GROUPS ===== */
        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            font-size: 14px;
            color: var(--gray-700);
            margin-bottom: 8px;
        }

        label i {
            color: var(--primary);
            width: 18px;
        }

        .required:after {
            content: ' *';
            color: var(--danger);
            font-weight: 600;
        }

        input, select, textarea {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid var(--gray-200);
            border-radius: 16px;
            font-size: 16px;
            outline: none;
            transition: 0.2s;
            background: var(--gray-50);
            font-family: inherit;
            -webkit-appearance: none;
            appearance: none;
        }

        /* Select dropdown custom arrow */
        select {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%230a2a66' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 16px center;
            background-size: 16px;
            padding-right: 48px;
        }

        input:focus, select:focus, textarea:focus {
            border-color: var(--primary);
            background: white;
            box-shadow: 0 0 0 4px rgba(10,42,102,0.1);
        }

        textarea {
            resize: vertical;
            min-height: 80px;
        }

        /* ===== ROW LAYOUT ===== */
        .row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        /* ===== DATE OF BIRTH WITH MONTH DISPLAY ===== */
        .dob-container {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .dob-input {
            flex: 2;
        }

        .month-display {
            flex: 1;
            background: #e6ecff;
            border-radius: 16px;
            padding: 14px;
            text-align: center;
            font-weight: 600;
            color: var(--primary);
            border: 2px solid var(--primary);
            font-size: 14px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .age-info {
            margin-top: 5px;
            font-size: 12px;
            color: var(--gray-500);
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .age-info i {
            color: var(--accent);
        }

        /* ===== CLASS SELECTION ===== */
        .class-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
            margin-top: 10px;
            max-height: 250px;
            overflow-y: auto;
            padding: 8px;
            border: 1px solid var(--gray-200);
            border-radius: 20px;
            background: var(--gray-50);
        }

        .class-btn {
            background: white;
            border: 2px solid var(--gray-200);
            border-radius: 40px;
            padding: 12px 4px;
            text-align: center;
            font-weight: 600;
            font-size: 13px;
            cursor: pointer;
            transition: 0.2s;
            -webkit-tap-highlight-color: transparent;
        }

        .class-btn:hover, .class-btn:active {
            border-color: var(--primary);
            background: #e6ecff;
        }

        .class-btn.selected {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
            box-shadow: 0 4px 12px rgba(10,42,102,0.2);
        }

        /* ===== FILE UPLOAD ===== */
        .file-upload {
            border: 2px dashed var(--gray-300);
            border-radius: 20px;
            padding: 25px;
            text-align: center;
            background: var(--gray-50);
            cursor: pointer;
            position: relative;
            transition: 0.2s;
        }

        .file-upload:hover, .file-upload:active {
            border-color: var(--primary);
            background: #e6ecff;
        }

        .file-upload i {
            font-size: 32px;
            color: var(--primary);
            margin-bottom: 10px;
        }

        .file-upload p {
            font-size: 14px;
            color: var(--gray-600);
            margin-bottom: 5px;
        }

        .file-upload small {
            font-size: 11px;
            color: var(--gray-500);
        }

        .file-upload input {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            cursor: pointer;
        }

        .file-name {
            margin-top: 10px;
            font-size: 12px;
            color: var(--primary);
            font-weight: 600;
            word-break: break-all;
        }

        .photo-preview {
            margin-top: 15px;
            text-align: center;
        }

        .photo-preview img {
            max-width: 120px;
            max-height: 120px;
            border-radius: 12px;
            border: 3px solid var(--primary);
            object-fit: cover;
        }

        /* ===== BUTTON GROUP ===== */
        .button-group {
            display: flex;
            gap: 12px;
            margin-top: 30px;
        }

        .btn {
            flex: 1;
            padding: 16px 20px;
            border: none;
            border-radius: 40px;
            font-weight: 700;
            font-size: 15px;
            cursor: pointer;
            transition: 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            -webkit-tap-highlight-color: transparent;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            box-shadow: 0 4px 12px rgba(10,42,102,0.2);
        }

        .btn-primary:hover, .btn-primary:active {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(10,42,102,0.3);
        }

        .btn-secondary {
            background: white;
            color: var(--gray-700);
            border: 2px solid var(--gray-200);
        }

        .btn-secondary:hover, .btn-secondary:active {
            background: var(--gray-100);
            transform: translateY(-2px);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-success:hover, .btn-success:active {
            background: #059669;
            transform: translateY(-2px);
        }

        .btn-print {
            background: var(--primary);
            color: white;
        }

        .btn-print:hover, .btn-print:active {
            background: var(--primary-dark);
        }

        /* ===== PREVIEW CARD (A4 STYLE) ===== */
        .preview-card {
            background: white;
            border-radius: 24px;
            padding: 30px 20px;
            margin-bottom: 25px;
            border: 1px solid var(--gray-200);
            max-height: 500px;
            overflow-y: auto;
            box-shadow: 0 8px 20px rgba(0,0,0,0.05);
        }

        .preview-header {
            text-align: center;
            border-bottom: 2px solid var(--primary);
            padding-bottom: 20px;
            margin-bottom: 25px;
        }

        .preview-header h2 {
            font-size: 24px;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 6px;
        }

        .preview-header p {
            font-size: 14px;
            color: var(--gray-600);
        }

        .preview-photo-section {
            display: flex;
            justify-content: flex-end;
            margin-bottom: 25px;
        }

        .preview-photo {
            width: 100px;
            height: 100px;
            border-radius: 12px;
            border: 3px solid var(--primary);
            overflow: hidden;
            background: #f0f0f0;
        }

        .preview-photo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .preview-section {
            margin-bottom: 25px;
        }

        .preview-section-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--gray-200);
        }

        .preview-section-title i {
            color: var(--accent);
        }

        .preview-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .preview-item {
            margin-bottom: 10px;
        }

        .preview-label {
            font-size: 11px;
            color: var(--gray-500);
            margin-bottom: 4px;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        .preview-value {
            font-size: 14px;
            font-weight: 600;
            color: var(--gray-800);
            word-break: break-word;
            padding: 6px 0;
            border-bottom: 1px dashed var(--gray-200);
        }

        .preview-timestamp {
            background: #e6ecff;
            padding: 15px;
            border-radius: 12px;
            margin: 20px 0;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 13px;
            color: var(--primary);
        }

        .declaration {
            margin-top: 30px;
            padding: 20px;
            background: var(--gray-50);
            border-radius: 16px;
            font-size: 13px;
            color: var(--gray-600);
            border-left: 4px solid var(--primary);
        }

        /* ===== PROGRESS BAR LOADING ===== */
        .loading-bar {
            width: 100%;
            height: 4px;
            background: var(--gray-200);
            border-radius: 4px;
            overflow: hidden;
            margin: 20px 0;
        }

        .loading-bar span {
            display: block;
            height: 100%;
            width: 30%;
            background: linear-gradient(90deg, var(--primary), var(--primary-dark));
            animation: loading 1.5s linear infinite;
        }

        @keyframes loading {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(300%); }
        }

        /* ===== PROFESSIONAL DIALOG ===== */
        .dialog {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            backdrop-filter: blur(8px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            padding: 16px;
        }

        .dialog-content {
            background: white;
            padding: 40px 30px;
            border-radius: 40px;
            max-width: 420px;
            width: 100%;
            text-align: center;
            animation: popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 30px 60px rgba(0,0,0,0.3);
            border: 1px solid rgba(10,42,102,0.1);
        }

        @keyframes popIn {
            from { opacity: 0; transform: scale(0.8) translateY(20px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }

        .dialog-icon {
            font-size: 60px;
            margin-bottom: 20px;
            background: #e6ecff;
            width: 100px;
            height: 100px;
            line-height: 100px;
            border-radius: 50%;
            margin: 0 auto 20px;
            color: var(--primary);
        }

        .dialog-title {
            font-size: 26px;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 12px;
        }

        .dialog-text {
            color: var(--gray-600);
            margin-bottom: 20px;
            line-height: 1.7;
            font-size: 15px;
        }

        .dialog-id-box {
            background: #e6ecff;
            padding: 18px;
            border-radius: 20px;
            margin: 20px 0;
        }

        .dialog-id-label {
            font-size: 12px;
            color: var(--primary);
            margin-bottom: 5px;
        }

        .dialog-id-value {
            font-size: 24px;
            font-weight: 800;
            color: var(--primary-dark);
            letter-spacing: 1px;
            word-break: break-all;
        }

        .dialog-time {
            font-size: 13px;
            color: var(--gray-500);
            margin-top: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .dialog-btn {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            border: none;
            padding: 16px 40px;
            border-radius: 60px;
            font-weight: 700;
            font-size: 16px;
            cursor: pointer;
            transition: 0.3s;
            box-shadow: 0 8px 25px rgba(10,42,102,0.3);
            margin-top: 10px;
        }

        .dialog-btn:hover, .dialog-btn:active {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(10,42,102,0.4);
        }

        /* ===== INFO BOX ===== */
        .info-box {
            background: #e6ecff;
            border-left: 4px solid var(--primary);
            padding: 16px;
            border-radius: 12px;
            margin-bottom: 20px;
            font-size: 13px;
            color: var(--primary);
        }

        /* ===== RESPONSIVE ===== */
        @media (max-width: 480px) {
            .progress-steps {
                overflow-x: auto;
                padding-bottom: 10px;
            }
            
            .step {
                min-width: 65px;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }

            .preview-grid {
                grid-template-columns: 1fr;
            }

            .class-grid {
                grid-template-columns: repeat(3, 1fr);
            }

            .dob-container {
                flex-direction: column;
            }

            .month-display {
                width: 100%;
            }

            .row {
                grid-template-columns: 1fr;
            }
        }

        /* ===== PRINT STYLES (A4) ===== */
        @media print {
            @page {
                size: A4;
                margin: 1.5cm;
            }

            body * {
                visibility: hidden;
            }

            .print-area, .print-area * {
                visibility: visible;
            }

            .print-area {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                background: white;
                padding: 40px 35px;
                font-size: 12pt;
            }

            .print-area .preview-header {
                text-align: center;
                border-bottom: 2px solid var(--primary);
                margin-bottom: 30px;
            }

            .print-area .preview-header h2 {
                font-size: 28pt;
                color: var(--primary);
                margin-bottom: 8px;
            }

            .print-area .preview-header p {
                font-size: 16pt;
                color: var(--gray-600);
            }

            .print-area .preview-section-title {
                font-size: 18pt;
                background: none;
                border-bottom: 2px solid var(--primary);
                margin-top: 25px;
                margin-bottom: 20px;
            }

            .print-area .preview-grid {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 25px 30px;
            }

            .print-area .preview-item {
                margin-bottom: 15px;
            }

            .print-area .preview-label {
                font-size: 11pt;
                color: var(--gray-600);
                text-transform: uppercase;
                font-weight: 500;
            }

            .print-area .preview-value {
                font-size: 14pt;
                color: var(--gray-800);
                font-weight: 600;
                border-bottom: 1px solid var(--gray-300);
                padding: 6px 0;
            }

            .print-area .preview-photo-section {
                display: flex;
                justify-content: flex-end;
                margin-bottom: 30px;
            }

            .print-area .preview-photo {
                width: 150px;
                height: 150px;
                border: 3px solid var(--primary);
                border-radius: 12px;
            }

            .print-area .declaration {
                margin-top: 40px;
                padding: 20px;
                font-size: 12pt;
                border-left: 4px solid var(--primary);
                background: var(--gray-50);
            }

            .print-area .preview-timestamp {
                background: none;
                border: 1px solid var(--gray-300);
                padding: 15px;
                margin: 30px 0;
            }

            .btn, .button-group, .progress-steps, .header, .dialog {
                display: none !important;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>
                <i class="fa-regular fa-pen-to-square"></i>
                ONLINE ADMISSION
                <i class="fa-regular fa-pen-to-square"></i>
            </h1>
            <p>Session 2026-27 • M.M Public School Mundeshwari</p>
        </div>

        <!-- Form Box -->
        <div class="form-box">
            <!-- Progress Steps -->
            <div class="progress-steps">
                <div class="step active" id="step1">
                    <div class="step-circle">1</div>
                    <div class="step-label">Personal</div>
                </div>
                <div class="step" id="step2">
                    <div class="step-circle">2</div>
                    <div class="step-label">Academic</div>
                </div>
                <div class="step" id="step3">
                    <div class="step-circle">3</div>
                    <div class="step-label">Preview</div>
                </div>
            </div>

            <!-- Form -->
            <form id="admissionForm">
                <!-- STEP 1 - PERSONAL DETAILS -->
                <div class="form-step active" id="formStep1">
                    <div class="section-title">
                        <i class="fa-regular fa-user"></i>
                        Personal Details
                    </div>

                    <!-- Student Name -->
                    <div class="form-group">
                        <label class="required"><i class="fa-regular fa-user"></i> Student's Full Name</label>
                        <input type="text" id="studentName" placeholder="As per certificate" required>
                    </div>

                    <!-- Father & Mother -->
                    <div class="row">
                        <div class="form-group">
                            <label class="required"><i class="fa-regular fa-user-tie"></i> Father's Name</label>
                            <input type="text" id="fatherName" required>
                        </div>
                        <div class="form-group">
                            <label class="required"><i class="fa-regular fa-user"></i> Mother's Name</label>
                            <input type="text" id="motherName" required>
                        </div>
                    </div>

                    <!-- DOB with Month Display -->
                    <div class="form-group">
                        <label class="required"><i class="fa-regular fa-calendar"></i> Date of Birth</label>
                        <div class="dob-container">
                            <div class="dob-input">
                                <input type="date" id="dob" required onchange="updateMonthDisplay()">
                            </div>
                            <div class="month-display" id="monthDisplay">
                                <span id="monthText">Select Date</span>
                            </div>
                        </div>
                        <div class="age-info">
                            <i class="fa-regular fa-clock"></i>
                            <span id="ageDisplay">Age will be calculated automatically</span>
                        </div>
                    </div>

                    <!-- Gender & Marital Status -->
                    <div class="row">
                        <div class="form-group">
                            <label class="required"><i class="fa-regular fa-venus-mars"></i> Gender</label>
                            <select id="gender" required>
                                <option value="">Select Gender</option>
                                <option value="Male">Male</option>
                                <option value="Female">Female</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label><i class="fa-regular fa-heart"></i> Marital Status</label>
                            <select id="maritalStatus">
                                <option value="Unmarried">Unmarried</option>
                                <option value="Married">Married</option>
                            </select>
                        </div>
                    </div>

                    <!-- Divyang & Category -->
                    <div class="row">
                        <div class="form-group">
                            <label><i class="fa-regular fa-wheelchair"></i> Divyang Category</label>
                            <select id="divyang">
                                <option value="No">No</option>
                                <option value="Yes - Visual">Yes - Visual</option>
                                <option value="Yes - Hearing">Yes - Hearing</option>
                                <option value="Yes - Physical">Yes - Physical</option>
                                <option value="Yes - Multiple">Yes - Multiple</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="required"><i class="fa-regular fa-layer-group"></i> Category</label>
                            <select id="category" required>
                                <option value="">Select Category</option>
                                <option value="General">General</option>
                                <option value="OBC">OBC</option>
                                <option value="SC">SC</option>
                                <option value="ST">ST</option>
                                <option value="EWS">EWS</option>
                            </select>
                        </div>
                    </div>

                    <!-- Aadhaar & Mobile -->
                    <div class="row">
                        <div class="form-group">
                            <label class="required"><i class="fa-regular fa-id-card"></i> Aadhaar Number</label>
                            <input type="text" id="aadhaar" maxlength="14" placeholder="1234-5678-9012" required>
                        </div>
                        <div class="form-group">
                            <label class="required"><i class="fa-regular fa-phone"></i> Mobile Number</label>
                            <input type="tel" id="mobile" maxlength="10" placeholder="9876543210" required>
                        </div>
                    </div>

                    <!-- Email & Nationality -->
                    <div class="row">
                        <div class="form-group">
                            <label><i class="fa-regular fa-envelope"></i> Email ID</label>
                            <input type="email" id="email" placeholder="name@example.com">
                        </div>
                        <div class="form-group">
                            <label class="required"><i class="fa-regular fa-flag"></i> Nationality</label>
                            <input type="text" id="nationality" value="Indian" required>
                        </div>
                    </div>

                    <!-- Address -->
                    <div class="form-group">
                        <label class="required"><i class="fa-regular fa-location-dot"></i> Permanent Address</label>
                        <textarea id="permanentAddress" rows="3" placeholder="House No., Street, Locality, City, PIN Code" required></textarea>
                    </div>

                    <!-- Class Selection -->
                    <div class="form-group">
                        <label class="required"><i class="fa-regular fa-school"></i> Applying for Class</label>
                        <div class="class-grid" id="classGrid"></div>
                        <input type="hidden" id="selectedClass">
                    </div>

                    <!-- Photo Upload -->
                    <div class="form-group">
                        <label class="required"><i class="fa-regular fa-camera"></i> Student Photo</label>
                        <div class="file-upload" id="photoUpload">
                            <i class="fa-regular fa-cloud-upload"></i>
                            <p>Click to upload photo</p>
                            <small>JPG, PNG • Max 2MB</small>
                            <div class="file-name" id="photoName"></div>
                            <input type="file" id="studentPhoto" accept="image/*" onchange="handlePhotoUpload(this)">
                        </div>
                        <div class="photo-preview" id="photoPreview"></div>
                    </div>

                    <div class="info-box">
                        <i class="fa-regular fa-circle-info"></i>
                        All fields marked with * are mandatory. Class selection is independent of previous education.
                    </div>

                    <div class="button-group">
                        <button type="button" class="btn btn-primary" onclick="nextStep()">
                            Next <i class="fa-regular fa-arrow-right"></i>
                        </button>
                    </div>
                </div>

                <!-- STEP 2 - ACADEMIC DETAILS -->
                <div class="form-step" id="formStep2">
                    <div class="section-title">
                        <i class="fa-regular fa-graduation-cap"></i>
                        Academic Details
                    </div>

                    <!-- Previous School -->
                    <div class="form-group">
                        <label class="required"><i class="fa-regular fa-building"></i> Previous School Name</label>
                        <input type="text" id="previousSchool" placeholder="Enter school name" required>
                    </div>

                    <!-- Previous Class & Board -->
                    <div class="row">
                        <div class="form-group">
                            <label class="required"><i class="fa-regular fa-clock"></i> Previous Class</label>
                            <input type="text" id="previousClass" placeholder="e.g., Class 9" required>
                        </div>
                        <div class="form-group">
                            <label class="required"><i class="fa-regular fa-building-columns"></i> Board / University</label>
                            <input type="text" id="boardName" placeholder="e.g., CBSE, BSEB" required>
                        </div>
                    </div>

                    <!-- Passing Year & Percentage -->
                    <div class="row">
                        <div class="form-group">
                            <label class="required"><i class="fa-regular fa-calendar"></i> Year of Passing</label>
                            <select id="passingYear" required>
                                <option value="">Select Year</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="required"><i class="fa-regular fa-percent"></i> Percentage / Marks</label>
                            <input type="number" id="percentage" min="0" max="100" step="0.01" placeholder="e.g., 85.5" required>
                        </div>
                    </div>

                    <!-- Entrance Exam Score (Optional) -->
                    <div class="form-group">
                        <label><i class="fa-regular fa-star"></i> Entrance Exam Score (Optional)</label>
                        <input type="text" id="entranceScore" placeholder="If applicable">
                    </div>

                    <div class="info-box">
                        <i class="fa-regular fa-circle-info"></i>
                        Previous academic details are mandatory for class 1 and above.
                    </div>

                    <div class="button-group">
                        <button type="button" class="btn btn-secondary" onclick="prevStep()">
                            <i class="fa-regular fa-arrow-left"></i> Back
                        </button>
                        <button type="button" class="btn btn-primary" onclick="showPreview()">
                            Preview <i class="fa-regular fa-eye"></i>
                        </button>
                    </div>
                </div>

                <!-- STEP 3 - FINAL PREVIEW (WITH PRINT CLASS) -->
                <div class="form-step" id="formStep3">
                    <div class="section-title">
                        <i class="fa-regular fa-file-lines"></i>
                        Application Preview
                    </div>

                    <div class="preview-card print-area" id="previewCard"></div>

                    <div class="button-group">
                        <button type="button" class="btn btn-secondary" onclick="prevStep()">
                            <i class="fa-regular fa-arrow-left"></i> Back
                        </button>
                        <button type="button" class="btn btn-print" onclick="window.print()">
                            <i class="fa-regular fa-print"></i> Print
                        </button>
                        <button type="submit" class="btn btn-success">
                            Final Submit <i class="fa-regular fa-check"></i>
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <!-- Success Dialog -->
    <div class="dialog" id="successDialog">
        <div class="dialog-content">
            <div class="dialog-icon">
                <i class="fa-regular fa-circle-check"></i>
            </div>
            <div class="dialog-title">Admission Successful!</div>
            <div class="dialog-text">
                Your application has been submitted successfully.
            </div>
            <div class="dialog-id-box">
                <div class="dialog-id-label">Admission ID</div>
                <div class="dialog-id-value" id="displayAdmissionId">ADM26001</div>
            </div>
            <div class="dialog-time" id="displayTimestamp">
                <i class="fa-regular fa-calendar"></i>
                <span></span>
            </div>
            <button class="dialog-btn" onclick="closeDialog()">OK</button>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script type="module">
        // ========== FIREBASE CONFIGURATION ==========
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
        import { getDatabase, ref, set, push, update, get } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-database.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-analytics.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAHAQjn4sTuR9FiGF3ljRrFEMZQjsx-SHg",
            authDomain: "apni-duniya-b53d7.firebaseapp.com",
            databaseURL: "https://apni-duniya-b53d7-default-rtdb.firebaseio.com",
            projectId: "apni-duniya-b53d7",
            storageBucket: "apni-duniya-b53d7.firebasestorage.app",
            messagingSenderId: "178853058918",
            appId: "1:178853058918:web:91dfaa5c5e41446da290a7",
            measurementId: "G-SW5SH1V2BB"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);
        const analytics = getAnalytics(app);

        // ========== CONFIGURATION ==========
        const CLOUDINARY_CONFIG = {
            cloudName: 'dty6vadm9',
            uploadPreset: 'examform'
        };

        // ========== GLOBAL VARIABLES ==========
        let currentStep = 1;
        const totalSteps = 3;
        let studentData = {};
        let photoURL = '';

        // ========== INITIALIZATION ==========
        document.addEventListener('DOMContentLoaded', function() {
            updateSteps();
            loadYears();
            loadClassGrid();
        });

        // ========== STEP NAVIGATION ==========
        window.nextStep = function() {
            if (validateStep(currentStep)) {
                document.getElementById(`step${currentStep}`).classList.remove('active');
                document.getElementById(`step${currentStep}`).classList.add('completed');
                document.getElementById(`formStep${currentStep}`).classList.remove('active');
                
                currentStep++;
                
                document.getElementById(`step${currentStep}`).classList.add('active');
                document.getElementById(`formStep${currentStep}`).classList.add('active');
                
                updateSteps();
            }
        }

        window.prevStep = function() {
            document.getElementById(`step${currentStep}`).classList.remove('active');
            document.getElementById(`formStep${currentStep}`).classList.remove('active');
            
            currentStep--;
            
            document.getElementById(`step${currentStep}`).classList.remove('completed');
            document.getElementById(`step${currentStep}`).classList.add('active');
            document.getElementById(`formStep${currentStep}`).classList.add('active');
            
            updateSteps();
        }

        function updateSteps() {
            for (let i = 1; i <= totalSteps; i++) {
                const step = document.getElementById(`step${i}`);
                if (i < currentStep) {
                    step.classList.add('completed');
                    step.classList.remove('active');
                } else if (i === currentStep) {
                    step.classList.add('active');
                    step.classList.remove('completed');
                } else {
                    step.classList.remove('active', 'completed');
                }
            }
        }

        // ========== CLASS GRID ==========
        function loadClassGrid() {
            const classes = ['Nursery', 'LKG', 'UKG', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12'];
            const grid = document.getElementById('classGrid');
            
            classes.forEach(cls => {
                const btn = document.createElement('div');
                btn.className = 'class-btn';
                btn.textContent = cls;
                btn.onclick = () => selectClass(cls, btn);
                grid.appendChild(btn);
            });
        }

        function selectClass(className, element) {
            document.querySelectorAll('.class-btn').forEach(btn => btn.classList.remove('selected'));
            element.classList.add('selected');
            document.getElementById('selectedClass').value = className;
        }

        // ========== DATE OF BIRTH FUNCTIONS ==========
        window.updateMonthDisplay = function() {
            const dob = document.getElementById('dob').value;
            if (!dob) {
                document.getElementById('monthText').textContent = 'Select Date';
                document.getElementById('ageDisplay').textContent = 'Age will be calculated automatically';
                return;
            }

            const date = new Date(dob);
            const months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
            const monthName = months[date.getMonth()];
            const year = date.getFullYear();
            
            document.getElementById('monthText').textContent = `${monthName} ${year}`;

            // Calculate age
            const today = new Date();
            let age = today.getFullYear() - date.getFullYear();
            const monthDiff = today.getMonth() - date.getMonth();
            
            if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < date.getDate())) {
                age--;
            }

            document.getElementById('ageDisplay').textContent = `Age: ${age} years (as of today)`;
        }

        // ========== LOAD YEARS ==========
        function loadYears() {
            const yearSelect = document.getElementById('passingYear');
            const currentYear = new Date().getFullYear();
            
            for (let year = currentYear + 1; year >= 1980; year--) {
                const option = document.createElement('option');
                option.value = year;
                option.textContent = year;
                yearSelect.appendChild(option);
            }
        }

        // ========== PHOTO UPLOAD TO CLOUDINARY ==========
        window.handlePhotoUpload = async function(input) {
            const file = input.files[0];
            if (!file) return;

            // Validate file size (2MB)
            if (file.size > 2 * 1024 * 1024) {
                showAlert('Photo size must be less than 2MB');
                return;
            }

            // Show preview
            const reader = new FileReader();
            reader.onload = function(e) {
                document.getElementById('photoPreview').innerHTML = `<img src="${e.target.result}" alt="Preview">`;
            };
            reader.readAsDataURL(file);

            // Update file name
            document.getElementById('photoName').textContent = file.name;

            // Show loading bar
            const loadingBar = document.createElement('div');
            loadingBar.className = 'loading-bar';
            loadingBar.innerHTML = '<span></span>';
            document.getElementById('photoUpload').appendChild(loadingBar);

            try {
                // Upload to Cloudinary
                const formData = new FormData();
                formData.append('file', file);
                formData.append('upload_preset', CLOUDINARY_CONFIG.uploadPreset);

                const response = await fetch(`https://api.cloudinary.com/v1_1/${CLOUDINARY_CONFIG.cloudName}/image/upload`, {
                    method: 'POST',
                    body: formData
                });

                const data = await response.json();
                
                if (data.secure_url) {
                    photoURL = data.secure_url;
                }
            } catch (error) {
                console.error('Upload failed:', error);
                showAlert('Photo upload failed. Please try again.');
            } finally {
                loadingBar.remove();
            }
        }

        // ========== VALIDATION ==========
        function validateStep(step) {
            switch(step) {
                case 1:
                    if (!document.getElementById('studentName').value.trim()) {
                        showAlert('Please enter student name');
                        return false;
                    }
                    if (!document.getElementById('fatherName').value.trim()) {
                        showAlert('Please enter father\'s name');
                        return false;
                    }
                    if (!document.getElementById('motherName').value.trim()) {
                        showAlert('Please enter mother\'s name');
                        return false;
                    }
                    if (!document.getElementById('dob').value) {
                        showAlert('Please select date of birth');
                        return false;
                    }
                    if (!document.getElementById('gender').value) {
                        showAlert('Please select gender');
                        return false;
                    }
                    if (!document.getElementById('category').value) {
                        showAlert('Please select category');
                        return false;
                    }
                    if (!document.getElementById('aadhaar').value.trim()) {
                        showAlert('Please enter Aadhaar number');
                        return false;
                    }
                    if (document.getElementById('aadhaar').value.replace(/\D/g, '').length !== 12) {
                        showAlert('Aadhaar must be 12 digits');
                        return false;
                    }
                    if (!document.getElementById('mobile').value.trim()) {
                        showAlert('Please enter mobile number');
                        return false;
                    }
                    if (document.getElementById('mobile').value.length !== 10) {
                        showAlert('Mobile number must be 10 digits');
                        return false;
                    }
                    if (!document.getElementById('nationality').value.trim()) {
                        showAlert('Please enter nationality');
                        return false;
                    }
                    if (!document.getElementById('permanentAddress').value.trim()) {
                        showAlert('Please enter permanent address');
                        return false;
                    }
                    if (!document.getElementById('selectedClass').value) {
                        showAlert('Please select class for admission');
                        return false;
                    }
                    if (!photoURL) {
                        showAlert('Please upload student photo');
                        return false;
                    }
                    return true;

                case 2:
                    if (!document.getElementById('previousSchool').value.trim()) {
                        showAlert('Please enter previous school name');
                        return false;
                    }
                    if (!document.getElementById('previousClass').value.trim()) {
                        showAlert('Please enter previous class');
                        return false;
                    }
                    if (!document.getElementById('boardName').value.trim()) {
                        showAlert('Please enter board/university name');
                        return false;
                    }
                    if (!document.getElementById('passingYear').value) {
                        showAlert('Please select passing year');
                        return false;
                    }
                    if (!document.getElementById('percentage').value) {
                        showAlert('Please enter percentage');
                        return false;
                    }
                    return true;

                default:
                    return true;
            }
        }

        function showAlert(message) {
            const dialog = document.getElementById('successDialog');
            dialog.querySelector('.dialog-icon').innerHTML = '<i class="fa-regular fa-circle-exclamation"></i>';
            dialog.querySelector('.dialog-title').textContent = 'Required Field';
            dialog.querySelector('.dialog-text').innerHTML = message;
            dialog.querySelector('.dialog-id-box').style.display = 'none';
            dialog.querySelector('.dialog-time').style.display = 'none';
            dialog.style.display = 'flex';
            
            setTimeout(() => {
                dialog.style.display = 'none';
                dialog.querySelector('.dialog-id-box').style.display = 'block';
                dialog.querySelector('.dialog-time').style.display = 'flex';
            }, 3000);
        }

        // ========== SHOW PREVIEW ==========
        window.showPreview = function() {
            if (!validateStep(2)) return;

            const selectedClass = document.getElementById('selectedClass').value;

            // Collect all data
            studentData = {
                // Personal
                name: document.getElementById('studentName').value,
                fatherName: document.getElementById('fatherName').value,
                motherName: document.getElementById('motherName').value,
                dob: document.getElementById('dob').value,
                gender: document.getElementById('gender').value,
                maritalStatus: document.getElementById('maritalStatus').value,
                divyang: document.getElementById('divyang').value,
                aadhaar: document.getElementById('aadhaar').value,
                mobile: document.getElementById('mobile').value,
                email: document.getElementById('email').value || 'Not provided',
                nationality: document.getElementById('nationality').value,
                category: document.getElementById('category').value,
                permanentAddress: document.getElementById('permanentAddress').value,
                classApplied: selectedClass,
                photoURL: photoURL,
                
                // Academic
                previousSchool: document.getElementById('previousSchool').value,
                previousClass: document.getElementById('previousClass').value,
                boardName: document.getElementById('boardName').value,
                passingYear: document.getElementById('passingYear').value,
                percentage: document.getElementById('percentage').value,
                entranceScore: document.getElementById('entranceScore').value || 'N/A'
            };

            const previewHTML = `
                <div class="preview-header">
                    <h2>M.M PUBLIC SCHOOL MUNDESHWARI</h2>
                    <p>Admission Application 2026-27</p>
                </div>

                <div class="preview-photo-section">
                    <div class="preview-photo">
                        <img src="${photoURL}" alt="Student Photo">
                    </div>
                </div>

                <div class="preview-section">
                    <div class="preview-section-title">
                        <i class="fa-regular fa-user"></i> Personal Details
                    </div>
                    <div class="preview-grid">
                        ${Object.entries({
                            'Student Name': studentData.name,
                            'Father\'s Name': studentData.fatherName,
                            'Mother\'s Name': studentData.motherName,
                            'Date of Birth': studentData.dob,
                            'Gender': studentData.gender,
                            'Marital Status': studentData.maritalStatus,
                            'Divyang': studentData.divyang,
                            'Aadhaar': studentData.aadhaar,
                            'Mobile': studentData.mobile,
                            'Email': studentData.email,
                            'Nationality': studentData.nationality,
                            'Category': studentData.category,
                            'Applying Class': studentData.classApplied
                        }).map(([key, value]) => `
                            <div class="preview-item">
                                <div class="preview-label">${key}</div>
                                <div class="preview-value">${value}</div>
                            </div>
                        `).join('')}
                        <div class="preview-item" style="grid-column: span 2;">
                            <div class="preview-label">Address</div>
                            <div class="preview-value">${studentData.permanentAddress}</div>
                        </div>
                    </div>
                </div>

                <div class="preview-section">
                    <div class="preview-section-title">
                        <i class="fa-regular fa-graduation-cap"></i> Academic Details
                    </div>
                    <div class="preview-grid">
                        ${Object.entries({
                            'Previous School': studentData.previousSchool,
                            'Previous Class': studentData.previousClass,
                            'Board/University': studentData.boardName,
                            'Passing Year': studentData.passingYear,
                            'Percentage': studentData.percentage + '%',
                            'Entrance Score': studentData.entranceScore
                        }).map(([key, value]) => `
                            <div class="preview-item">
                                <div class="preview-label">${key}</div>
                                <div class="preview-value">${value}</div>
                            </div>
                        `).join('')}
                    </div>
                </div>

                <div class="preview-timestamp">
                    <i class="fa-regular fa-clock"></i>
                    Generated on: ${new Date().toLocaleDateString('en-IN')} at ${new Date().toLocaleTimeString('en-IN')}
                </div>

                <div class="declaration">
                    <i class="fa-regular fa-file-signature"></i>
                    I hereby declare that all the information provided above is true and correct to the best of my knowledge.
                </div>
            `;

            document.getElementById('previewCard').innerHTML = previewHTML;
            nextStep();
        }

        // ========== ID GENERATION ==========
        function generateAdmissionId() {
            const prefix = 'ADM';
            const year = new Date().getFullYear().toString().slice(-2);
            const random = Math.floor(Math.random() * 9000 + 1000);
            return `${prefix}${year}${random}`;
        }

        function generateUniqueId() {
            const random = Math.floor(Math.random() * 10000000000000);
            return `MMPSM${random.toString().padStart(13, '0')}`;
        }

        function generateRegistrationNo(uniqueId) {
            const year = new Date().getFullYear();
            const last4 = uniqueId.slice(-4);
            const random = Math.floor(Math.random() * 900 + 100);
            return `R-${year}-${last4}-${random}`;
        }

        function generateRollNumber(className) {
            // Class code mapping
            const classCodes = {
                'Nursery': '01', 'LKG': '02', 'UKG': '03', '1': '04', '2': '05', '3': '06',
                '4': '07', '5': '08', '6': '09', '7': '10', '8': '11', '9': '12',
                '10': '13', '11': '14', '12': '15'
            };
            
            const year = new Date().getFullYear().toString().slice(-2);
            const classCode = classCodes[className] || '00';
            const random = Math.floor(Math.random() * 900 + 100);
            
            return `${year}${classCode}${random}`;
        }

        // ========== SAVE TO FIREBASE ==========
        async function saveToFirebase(admissionData) {
            try {
                const admissionId = admissionData.admissionId;
                await set(ref(database, 'admissions/' + admissionId), admissionData);
                
                // Update class count
                const classRef = ref(database, 'classCounts/' + admissionData.classApplied);
                const snapshot = await get(classRef);
                const currentCount = snapshot.val() || 0;
                await set(classRef, currentCount + 1);
                
                return true;
            } catch (error) {
                console.error('Firebase save error:', error);
                return false;
            }
        }

        // ========== FORM SUBMISSION ==========
        document.getElementById('admissionForm').addEventListener('submit', async function(e) {
            e.preventDefault();

            if (!validateStep(2)) return;

            // Show loading bar
            const loadingBar = document.createElement('div');
            loadingBar.className = 'loading-bar';
            loadingBar.innerHTML = '<span></span>';
            document.getElementById('formStep3').appendChild(loadingBar);

            try {
                // Generate IDs
                const uniqueId = generateUniqueId();
                const registrationNo = generateRegistrationNo(uniqueId);
                const rollNo = generateRollNumber(studentData.classApplied);
                const admissionId = generateAdmissionId();
                const timestamp = Date.now();
                const dateObj = new Date(timestamp);

                // Prepare final data
                const finalData = {
                    // Student visible IDs
                    admissionId: admissionId,
                    
                    // Personal Details
                    name: studentData.name,
                    fatherName: studentData.fatherName,
                    motherName: studentData.motherName,
                    dob: studentData.dob,
                    gender: studentData.gender,
                    maritalStatus: studentData.maritalStatus,
                    divyang: studentData.divyang,
                    aadhaar: studentData.aadhaar,
                    mobile: studentData.mobile,
                    email: studentData.email,
                    nationality: studentData.nationality,
                    category: studentData.category,
                    permanentAddress: studentData.permanentAddress,
                    classApplied: studentData.classApplied,
                    photoURL: studentData.photoURL,
                    
                    // Academic Details
                    previousSchool: studentData.previousSchool,
                    previousClass: studentData.previousClass,
                    boardName: studentData.boardName,
                    passingYear: studentData.passingYear,
                    percentage: studentData.percentage,
                    entranceScore: studentData.entranceScore,
                    
                    // Admin only IDs
                    uniqueId: uniqueId,
                    registrationNo: registrationNo,
                    rollNo: rollNo,
                    
                    // Metadata
                    timestamp: timestamp,
                    date: dateObj.toLocaleDateString('en-IN'),
                    time: dateObj.toLocaleTimeString('en-IN'),
                    fullDate: dateObj.toISOString(),
                    status: 'pending'
                };

                // Save to Firebase
                const saved = await saveToFirebase(finalData);
                
                if (saved) {
                    // Show success dialog
                    const dialog = document.getElementById('successDialog');
                    dialog.querySelector('.dialog-icon').innerHTML = '<i class="fa-regular fa-circle-check"></i>';
                    dialog.querySelector('.dialog-title').textContent = 'Admission Successful!';
                    dialog.querySelector('.dialog-text').innerHTML = 'Your application has been submitted successfully.';
                    
                    document.getElementById('displayAdmissionId').textContent = admissionId;
                    
                    const timeSpan = document.getElementById('displayTimestamp').querySelector('span');
                    timeSpan.textContent = `${finalData.date} at ${finalData.time}`;
                    
                    dialog.querySelector('.dialog-id-box').style.display = 'block';
                    dialog.querySelector('.dialog-time').style.display = 'flex';
                    dialog.style.display = 'flex';

                    console.log('✅ Data saved to Firebase:', finalData);
                } else {
                    showAlert('Failed to save data. Please try again.');
                }

            } catch (error) {
                console.error('Submission error:', error);
                showAlert('Something went wrong. Please try again.');
            } finally {
                loadingBar.remove();
            }
        });

        // ========== CLOSE DIALOG ==========
        window.closeDialog = function() {
            document.getElementById('successDialog').style.display = 'none';
            // Redirect or reset after 1 second
            setTimeout(() => {
                location.reload();
            }, 1000);
        }

        // Close on outside click
        document.getElementById('successDialog').addEventListener('click', function(e) {
            if (e.target === this) {
                closeDialog();
            }
        });

        // Auto-format Aadhaar
        document.getElementById('aadhaar').addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length > 12) value = value.slice(0, 12);
            
            if (value.length > 8) {
                value = value.slice(0, 4) + '-' + value.slice(4, 8) + '-' + value.slice(8);
            } else if (value.length > 4) {
                value = value.slice(0, 4) + '-' + value.slice(4);
            }
            
            e.target.value = value;
        });
    </script>
</body>
</html>